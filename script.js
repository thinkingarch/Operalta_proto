{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red183\green111\blue247;\red23\green24\blue24;\red202\green202\blue202;
\red212\green212\blue212;\red54\green192\blue160;\red113\green192\blue131;\red109\green115\blue120;\red246\green124\blue48;
}
{\*\expandedcolortbl;;\cssrgb\c77255\c54118\c97647;\cssrgb\c11765\c12157\c12549;\cssrgb\c83137\c83137\c83137;
\cssrgb\c86275\c86275\c86275;\cssrgb\c23922\c78824\c69020;\cssrgb\c50588\c78824\c58431;\cssrgb\c50196\c52549\c54510;\cssrgb\c98039\c56471\c24314;
}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\fs28 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 import\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf6 \cb3 \strokec6 GoogleGenAI\cf4 \cb3 \strokec4  \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 from\cf4 \strokec4  \cf7 \strokec7 "@google/genai"\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 import\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  marked \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 from\cf4 \strokec4  \cf7 \strokec7 "marked"\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 import\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  initializeApp \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 from\cf4 \strokec4  \cf7 \strokec7 "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js"\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 import\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  getFirestore\cf5 \strokec5 ,\cf4 \strokec4  collection\cf5 \strokec5 ,\cf4 \strokec4  getDocs\cf5 \strokec5 ,\cf4 \strokec4  addDoc\cf5 \strokec5 ,\cf4 \strokec4  doc\cf5 \strokec5 ,\cf4 \strokec4  setDoc \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 from\cf4 \strokec4  \cf7 \strokec7 "https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore.js"\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 // --- Firebase Configuration ---\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 // IMPORTANT: Replace this with your project's configuration object\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 const\cf4 \strokec4  firebaseConfig \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4   apiKey\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_API_KEY"\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4   authDomain\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_PROJECT_ID.firebaseapp.com"\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4   projectId\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_PROJECT_ID"\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4   storageBucket\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_PROJECT_ID.appspot.com"\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4   messagingSenderId\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_SENDER_ID"\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4   appId\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "YOUR_APP_ID"\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 \};\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 // Initialize Firebase\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 const\cf4 \strokec4  app \cf5 \strokec5 =\cf4 \strokec4  initializeApp\cf5 \strokec5 (\cf4 \strokec4 firebaseConfig\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 const\cf4 \strokec4  db \cf5 \strokec5 =\cf4 \strokec4  getFirestore\cf5 \strokec5 (\cf4 \strokec4 app\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf8 \cb3 \strokec8 // --- End of Firebase Configuration ---\cf4 \cb1 \strokec4 \
\
\
\pard\pardeftab720\partightenfactor0
\cf2 \cb3 \strokec2 const\cf4 \strokec4  \cf6 \cb3 \strokec6 MODEL_NAME\cf4 \cb3 \strokec4  \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'gemini-1.5-flash'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\cf2 \cb3 \strokec2 class\cf4 \strokec4  \cf6 \cb3 \strokec6 DictationService\cf4 \cb3 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4     \cf2 \strokec2 constructor\cf5 \strokec5 (\cf4 \strokec4 options\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 genAI \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 apiKey \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 apiKey\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 jsonModel \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 textModel \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 apiKey\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 try\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 genAI \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 GoogleGenAI\cf5 \cb3 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 apiKey\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 textModel \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 genAI\cf5 \strokec5 .\cf4 \strokec4 getGenerativeModel\cf5 \strokec5 (\{\cf4 \strokec4  model\cf5 \strokec5 :\cf4 \strokec4  \cf6 \cb3 \strokec6 MODEL_NAME\cf4 \cb3 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 jsonModel \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 genAI\cf5 \strokec5 .\cf4 \strokec4 getGenerativeModel\cf5 \strokec5 (\{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                     model\cf5 \strokec5 :\cf4 \strokec4  \cf6 \cb3 \strokec6 MODEL_NAME\cf5 \cb3 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                     generationConfig\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  responseMimeType\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 "application/json"\cf4 \strokec4  \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 catch\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 console\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 (\cf7 \strokec7 "Failed to initialize GoogleGenAI:"\cf5 \strokec5 ,\cf4 \strokec4  e\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStart \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 onRecordingStart\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStop \cf5 \strokec5 =\cf4 \strokec4  options\cf5 \strokec5 .\cf4 \strokec4 onRecordingStop\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'liveWaveformCanvas'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveRecordingTimerDisplay \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'liveRecordingTimerDisplay'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingInterface \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'recording-interface'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveRecordingTitle \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'liveRecordingTitle'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCtx \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas\cf5 \strokec5 .\cf4 \strokec4 getContext\cf5 \strokec5 (\cf7 \strokec7 '2d'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioChunks \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 [];\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 false\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 bindEventListeners\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     isReady\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 return\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 genAI \cf5 \strokec5 !==\cf4 \strokec4  \cf2 \strokec2 null\cf4 \strokec4  \cf5 \strokec5 &&\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 jsonModel \cf5 \strokec5 !==\cf4 \strokec4  \cf2 \strokec2 null\cf4 \strokec4  \cf5 \strokec5 &&\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 textModel \cf5 \strokec5 !==\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     bindEventListeners\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 toggleRecording\cf5 \strokec5 ());\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         window\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'resize'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 handleResize\cf5 \strokec5 ());\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     handleResize\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording\cf5 \strokec5 )\cf4 \strokec4  requestAnimationFrame\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 setupCanvasDimensions\cf5 \strokec5 ());\cf4 \strokec4  \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     setupCanvasDimensions\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas \cf5 \strokec5 ||\cf4 \strokec4  \cf5 \strokec5 !\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCtx\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  canvas \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  dpr \cf5 \strokec5 =\cf4 \strokec4  window\cf5 \strokec5 .\cf4 \strokec4 devicePixelRatio \cf5 \strokec5 ||\cf4 \strokec4  \cf9 \cb3 \strokec9 1\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  rect \cf5 \strokec5 =\cf4 \strokec4  canvas\cf5 \strokec5 .\cf4 \strokec4 getBoundingClientRect\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         canvas\cf5 \strokec5 .\cf4 \strokec4 width \cf5 \strokec5 =\cf4 \strokec4  rect\cf5 \strokec5 .\cf4 \strokec4 width \cf5 \strokec5 *\cf4 \strokec4  dpr\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         canvas\cf5 \strokec5 .\cf4 \strokec4 height \cf5 \strokec5 =\cf4 \strokec4  rect\cf5 \strokec5 .\cf4 \strokec4 height \cf5 \strokec5 *\cf4 \strokec4  dpr\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCtx\cf5 \strokec5 .\cf4 \strokec4 setTransform\cf5 \strokec5 (\cf4 \strokec4 dpr\cf5 \strokec5 ,\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf4 \strokec4  dpr\cf5 \strokec5 ,\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  toggleRecording\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isReady\cf5 \strokec5 ())\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             console\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 (\cf7 \strokec7 "Dictation service not ready. API Key might be missing or invalid."\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'API Key invalid.'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 .\cf4 \strokec4 style\cf5 \strokec5 .\cf4 \strokec4 color \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'red'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording \cf5 \strokec5 ?\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stopRecording\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 startRecording\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  startRecording\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 try\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioChunks \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 [];\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Requesting microphone...'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  navigator\cf5 \strokec5 .\cf4 \strokec4 mediaDevices\cf5 \strokec5 .\cf4 \strokec4 getUserMedia\cf5 \strokec5 (\{\cf4 \strokec4  audio\cf5 \strokec5 :\cf4 \strokec4  \cf2 \strokec2 true\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 MediaRecorder\cf5 \cb3 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder\cf5 \strokec5 .\cf4 \strokec4 ondataavailable \cf5 \strokec5 =\cf4 \strokec4  e \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 .\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 size \cf5 \strokec5 >\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioChunks\cf5 \strokec5 .\cf4 \strokec4 push\cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 .\cf4 \strokec4 data\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder\cf5 \strokec5 .\cf4 \strokec4 onstop \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStop\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStop\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stopLiveDisplay\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioChunks\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 >\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                     \cf2 \strokec2 const\cf4 \strokec4  audioBlob \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Blob\cf5 \cb3 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioChunks\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  type\cf5 \strokec5 :\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder\cf5 \strokec5 ?.\cf4 \strokec4 mimeType \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'audio/webm'\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                     \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 processAudio\cf5 \strokec5 (\cf4 \strokec4 audioBlob\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream\cf5 \strokec5 .\cf4 \strokec4 getTracks\cf5 \strokec5 ().\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 track \cf5 \strokec5 =>\cf4 \strokec4  track\cf5 \strokec5 .\cf4 \strokec4 stop\cf5 \strokec5 ());\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder\cf5 \strokec5 .\cf4 \strokec4 start\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 true\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'recording'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 title \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Stop Recording'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 startLiveDisplay\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 if\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStart\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onRecordingStart\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 catch\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 error\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             console\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 (\cf7 \strokec7 "Error starting recording:"\cf5 \strokec5 ,\cf4 \strokec4  error\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Microphone access denied.'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  stopRecording\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder \cf5 \strokec5 &&\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 mediaRecorder\cf5 \strokec5 .\cf4 \strokec4 stop\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 false\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'recording'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 title \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Start Recording'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 statusTextElement\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Processing...'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     startLiveDisplay\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingInterface\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'is-live'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 [\cf7 \strokec7 'liveRecordingTitle'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'liveWaveformCanvas'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'liveRecordingTimerDisplay'\cf5 \strokec5 ].\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 id \cf5 \strokec5 =>\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf4 \strokec4 id\cf5 \strokec5 )?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 setupCanvasDimensions\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  icon \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 querySelector\cf5 \strokec5 (\cf7 \strokec7 'i'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 icon\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  icon\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'fa-microphone'\cf5 \strokec5 );\cf4 \strokec4  icon\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'fa-stop'\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 setupAudioVisualizer\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 drawLiveWaveform\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingStartTime \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 .\cf4 \strokec4 now\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 timerIntervalId\cf5 \strokec5 )\cf4 \strokec4  clearInterval\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 timerIntervalId\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 timerIntervalId \cf5 \strokec5 =\cf4 \strokec4  setInterval\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 updateLiveTimer\cf5 \strokec5 (),\cf4 \strokec4  \cf9 \cb3 \strokec9 50\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     stopLiveDisplay\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4          \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingInterface\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'is-live'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4          setTimeout\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingInterface\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ),\cf4 \strokec4  \cf9 \cb3 \strokec9 500\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 [\cf7 \strokec7 'liveRecordingTitle'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'liveWaveformCanvas'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'liveRecordingTimerDisplay'\cf5 \strokec5 ].\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 id \cf5 \strokec5 =>\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf4 \strokec4 id\cf5 \strokec5 )?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  icon \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 .\cf4 \strokec4 querySelector\cf5 \strokec5 (\cf7 \strokec7 'i'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 icon\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  icon\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'fa-stop'\cf5 \strokec5 );\cf4 \strokec4  icon\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'fa-microphone'\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDrawingId\cf5 \strokec5 )\cf4 \strokec4  cancelAnimationFrame\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDrawingId\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 timerIntervalId\cf5 \strokec5 )\cf4 \strokec4  clearInterval\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 timerIntervalId\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext \cf5 \strokec5 &&\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext\cf5 \strokec5 .\cf4 \strokec4 state \cf5 \strokec5 !==\cf4 \strokec4  \cf7 \strokec7 'closed'\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext\cf5 \strokec5 .\cf4 \strokec4 close\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     setupAudioVisualizer\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 AudioContext\cf5 \cb3 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  source \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext\cf5 \strokec5 .\cf4 \strokec4 createMediaStreamSource\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 stream\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 audioContext\cf5 \strokec5 .\cf4 \strokec4 createAnalyser\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode\cf5 \strokec5 .\cf4 \strokec4 fftSize \cf5 \strokec5 =\cf4 \strokec4  \cf9 \cb3 \strokec9 256\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDataArray \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Uint8Array\cf5 \cb3 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode\cf5 \strokec5 .\cf4 \strokec4 frequencyBinCount\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         source\cf5 \strokec5 .\cf4 \strokec4 connect\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     drawLiveWaveform\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 isRecording\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         requestAnimationFrame\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 drawLiveWaveform\cf5 \strokec5 ());\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 analyserNode\cf5 \strokec5 .\cf4 \strokec4 getByteFrequencyData\cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDataArray\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  ctx \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCtx\cf5 \strokec5 ,\cf4 \strokec4  canvas \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveWaveformCanvas\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf5 \strokec5 (!\cf4 \strokec4 ctx \cf5 \strokec5 ||\cf4 \strokec4  \cf5 \strokec5 !\cf4 \strokec4 canvas\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ctx\cf5 \strokec5 .\cf4 \strokec4 clearRect\cf5 \strokec5 (\cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf4 \strokec4  canvas\cf5 \strokec5 .\cf4 \strokec4 clientWidth\cf5 \strokec5 ,\cf4 \strokec4  canvas\cf5 \strokec5 .\cf4 \strokec4 clientHeight\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  numBars \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDataArray\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 *\cf4 \strokec4  \cf9 \cb3 \strokec9 0.5\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  barWidth \cf5 \strokec5 =\cf4 \strokec4  canvas\cf5 \strokec5 .\cf4 \strokec4 clientWidth \cf5 \strokec5 /\cf4 \strokec4  numBars \cf5 \strokec5 *\cf4 \strokec4  \cf9 \cb3 \strokec9 0.7\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 let\cf4 \strokec4  x \cf5 \strokec5 =\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ctx\cf5 \strokec5 .\cf4 \strokec4 fillStyle \cf5 \strokec5 =\cf4 \strokec4  getComputedStyle\cf5 \strokec5 (\cf4 \strokec4 document\cf5 \strokec5 .\cf4 \strokec4 documentElement\cf5 \strokec5 ).\cf4 \strokec4 getPropertyValue\cf5 \strokec5 (\cf7 \strokec7 '--color-recording'\cf5 \strokec5 ).\cf4 \strokec4 trim\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 for\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 let\cf4 \strokec4  i \cf5 \strokec5 =\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ;\cf4 \strokec4  i \cf5 \strokec5 <\cf4 \strokec4  numBars\cf5 \strokec5 ;\cf4 \strokec4  i\cf5 \strokec5 ++)\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  barHeight \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 waveformDataArray\cf5 \strokec5 [\cf4 \strokec4 i\cf5 \strokec5 ]\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 255\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 *\cf4 \strokec4  canvas\cf5 \strokec5 .\cf4 \strokec4 clientHeight\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ctx\cf5 \strokec5 .\cf4 \strokec4 fillRect\cf5 \strokec5 (\cf4 \strokec4 x\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 canvas\cf5 \strokec5 .\cf4 \strokec4 clientHeight \cf5 \strokec5 -\cf4 \strokec4  barHeight\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 2\cf5 \cb3 \strokec5 ,\cf4 \strokec4  barWidth\cf5 \strokec5 ,\cf4 \strokec4  barHeight\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             x \cf5 \strokec5 +=\cf4 \strokec4  barWidth \cf5 \strokec5 *\cf4 \strokec4  \cf9 \cb3 \strokec9 1.3\cf5 \cb3 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     updateLiveTimer\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  elapsedMs \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 .\cf4 \strokec4 now\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 -\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 recordingStartTime\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  minutes \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Math\cf5 \cb3 \strokec5 .\cf4 \strokec4 floor\cf5 \strokec5 (\cf4 \strokec4 elapsedMs \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 60000\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  seconds \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Math\cf5 \cb3 \strokec5 .\cf4 \strokec4 floor\cf5 \strokec5 ((\cf4 \strokec4 elapsedMs \cf5 \strokec5 %\cf4 \strokec4  \cf9 \cb3 \strokec9 60000\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 1000\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  hundredths \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Math\cf5 \cb3 \strokec5 .\cf4 \strokec4 floor\cf5 \strokec5 ((\cf4 \strokec4 elapsedMs \cf5 \strokec5 %\cf4 \strokec4  \cf9 \cb3 \strokec9 1000\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 10\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 liveRecordingTimerDisplay\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf5 \strokec5 $\{\cf6 \cb3 \strokec6 String\cf5 \cb3 \strokec5 (\cf4 \strokec4 minutes\cf5 \strokec5 ).\cf4 \strokec4 padStart\cf5 \strokec5 (\cf9 \cb3 \strokec9 2\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 '0'\cf5 \strokec5 )\}\cf7 \strokec7 :\cf5 \strokec5 $\{\cf6 \cb3 \strokec6 String\cf5 \cb3 \strokec5 (\cf4 \strokec4 seconds\cf5 \strokec5 ).\cf4 \strokec4 padStart\cf5 \strokec5 (\cf9 \cb3 \strokec9 2\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 '0'\cf5 \strokec5 )\}\cf7 \strokec7 .\cf5 \strokec5 $\{\cf6 \cb3 \strokec6 String\cf5 \cb3 \strokec5 (\cf4 \strokec4 hundredths\cf5 \strokec5 ).\cf4 \strokec4 padStart\cf5 \strokec5 (\cf9 \cb3 \strokec9 2\cf5 \cb3 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 '0'\cf5 \strokec5 )\}\cf7 \strokec7 `\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  processAudio\cf5 \strokec5 (\cf4 \strokec4 audioBlob\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  base64Audio \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Promise\cf5 \cb3 \strokec5 ((\cf4 \strokec4 resolve\cf5 \strokec5 ,\cf4 \strokec4  reject\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  reader \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 FileReader\cf5 \cb3 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             reader\cf5 \strokec5 .\cf4 \strokec4 onloadend \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  resolve\cf5 \strokec5 (\cf4 \strokec4 reader\cf5 \strokec5 .\cf4 \strokec4 result\cf5 \strokec5 .\cf4 \strokec4 split\cf5 \strokec5 (\cf7 \strokec7 ','\cf5 \strokec5 )[\cf9 \cb3 \strokec9 1\cf5 \cb3 \strokec5 ]);\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             reader\cf5 \strokec5 .\cf4 \strokec4 onerror \cf5 \strokec5 =\cf4 \strokec4  reject\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             reader\cf5 \strokec5 .\cf4 \strokec4 readAsDataURL\cf5 \strokec5 (\cf4 \strokec4 audioBlob\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  audioPart \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             inlineData\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 mimeType\cf5 \strokec5 :\cf4 \strokec4  audioBlob\cf5 \strokec5 .\cf4 \strokec4 type\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 data\cf5 \strokec5 :\cf4 \strokec4  base64Audio\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 getTranscription\cf5 \strokec5 (\cf4 \strokec4 audioPart\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  getTranscription\cf5 \strokec5 (\cf4 \strokec4 audioPart\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 try\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  prompt \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Please provide a verbatim transcript of this audio recording.'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  result \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 textModel\cf5 \strokec5 .\cf4 \strokec4 generateContent\cf5 \strokec5 ([\cf4 \strokec4 prompt\cf5 \strokec5 ,\cf4 \strokec4  audioPart\cf5 \strokec5 ]);\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  transcription \cf5 \strokec5 =\cf4 \strokec4  result\cf5 \strokec5 .\cf4 \strokec4 response\cf5 \strokec5 .\cf4 \strokec4 text\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 getPolishedNote\cf5 \strokec5 (\cf4 \strokec4 transcription\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 catch\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 error\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             console\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 (\cf7 \strokec7 "Error during transcription:"\cf5 \strokec5 ,\cf4 \strokec4  error\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete\cf5 \strokec5 (\cf2 \strokec2 null\cf5 \strokec5 ,\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  error\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 `Transcription failed: \cf5 \strokec5 $\{\cf4 \strokec4 error\cf5 \strokec5 .\cf4 \strokec4 message\cf5 \strokec5 \}\cf7 \strokec7 `\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \strokec4  \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  getPolishedNote\cf5 \strokec5 (\cf4 \strokec4 rawTranscription\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4          \cf2 \strokec2 try\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf4 \strokec4 rawTranscription\cf5 \strokec5 .\cf4 \strokec4 trim\cf5 \strokec5 ())\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete\cf5 \strokec5 (\cf2 \strokec2 null\cf5 \strokec5 ,\cf4 \strokec4  rawTranscription\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  arr\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 ,\cf4 \strokec4  growth\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 ,\cf4 \strokec4  runway\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  prompt \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `Analyze the following raw transcript of a CEO's weekly update and extract key information. Here is the transcript: --- \cf5 \strokec5 $\{\cf4 \strokec4 rawTranscription\cf5 \strokec5 \}\cf7 \strokec7  ---`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  result \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 jsonModel\cf5 \strokec5 .\cf4 \strokec4 generateContent\cf5 \strokec5 (\cf4 \strokec4 prompt\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  responseText \cf5 \strokec5 =\cf4 \strokec4  result\cf5 \strokec5 .\cf4 \strokec4 response\cf5 \strokec5 .\cf4 \strokec4 text\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  data \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 JSON\cf5 \cb3 \strokec5 .\cf4 \strokec4 parse\cf5 \strokec5 (\cf4 \strokec4 responseText\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 ,\cf4 \strokec4  rawTranscription\cf5 \strokec5 ,\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 catch\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 error\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             console\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 (\cf7 \strokec7 "Error during polishing:"\cf5 \strokec5 ,\cf4 \strokec4  error\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 onProcessingComplete\cf5 \strokec5 (\cf2 \strokec2 null\cf5 \strokec5 ,\cf4 \strokec4  rawTranscription\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  error\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 `AI analysis failed: \cf5 \strokec5 $\{\cf4 \strokec4 error\cf5 \strokec5 .\cf4 \strokec4 message\cf5 \strokec5 \}\cf7 \strokec7 `\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4 document\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'DOMContentLoaded'\cf5 \strokec5 ,\cf4 \strokec4  \cf2 \strokec2 function\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  dictationService \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 null\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  currentView \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'ceo'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  latestGeneratedReport \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  activePlaybookCategories \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 [];\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  reportsData \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 let\cf4 \strokec4  playbooksData \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\};\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 const\cf4 \strokec4  ui \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         sidebar\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'sidebar'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         mobileMenuBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'mobile-menu-btn'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ceoView\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ceo-view'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         vcView\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'vc-view'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ceoNav\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ceo-nav'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         vcNav\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'vc-nav'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ceoPlaybookList\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ceo-playbook-list'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         playbookCategoryFilters\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'playbook-category-filters'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         vcPortfolioList\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'vc-portfolio-list'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         reportsTableBody\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 querySelector\cf5 \strokec5 (\cf7 \strokec7 '#page-reports tbody'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         pages\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              dashboard\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-dashboard'\cf5 \strokec5 ),\cf4 \strokec4  recording\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-recording'\cf5 \strokec5 ),\cf4 \strokec4  reports\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-reports'\cf5 \strokec5 ),\cf4 \strokec4  playbooks\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-playbooks'\cf5 \strokec5 ),\cf4 \strokec4  integrations\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-integrations'\cf5 \strokec5 ),\cf4 \strokec4  settings\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-settings'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              vcDashboard\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-vc-dashboard'\cf5 \strokec5 ),\cf4 \strokec4  vcPlaybooks\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-vc-playbooks'\cf5 \strokec5 ),\cf4 \strokec4  vcSettings\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'page-vc-settings'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         navLinks\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ceo\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  dashboard\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-dashboard'\cf5 \strokec5 ),\cf4 \strokec4  reports\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-reports'\cf5 \strokec5 ),\cf4 \strokec4  playbooks\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-playbooks'\cf5 \strokec5 ),\cf4 \strokec4  integrations\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-integrations'\cf5 \strokec5 ),\cf4 \strokec4  settings\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-settings'\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             vc\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  dashboard\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-vc-dashboard'\cf5 \strokec5 ),\cf4 \strokec4  playbooks\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-vc-playbooks'\cf5 \strokec5 ),\cf4 \strokec4  settings\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'nav-vc-settings'\cf5 \strokec5 ),\cf4 \strokec4  \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         startRecordingBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'start-recording-btn'\cf5 \strokec5 ),\cf4 \strokec4  newReportBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'new-report-btn'\cf5 \strokec5 ),\cf4 \strokec4  recordButton\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'recordButton'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         recordingInterface\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'recording-interface'\cf5 \strokec5 ),\cf4 \strokec4  processingState\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'processing-state'\cf5 \strokec5 ),\cf4 \strokec4  processingStatus\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'processing-status'\cf5 \strokec5 ),\cf4 \strokec4  completedState\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'completed-state'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         extractedIntelligenceContainer\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'extracted-intelligence'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         strategicUpdateContainer\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'strategic-update'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         authorPlaybookBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'author-playbook-btn'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         apiKeyBanner\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'api-key-banner'\cf5 \strokec5 ),\cf4 \strokec4  bannerSettingsLink\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'banner-settings-link'\cf5 \strokec5 ),\cf4 \strokec4  apiKeyInput\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'api-key-input'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         saveApiKeyBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'save-api-key-btn'\cf5 \strokec5 ),\cf4 \strokec4  apiKeyStatus\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'api-key-status'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         viewToggle\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'view-toggle'\cf5 \strokec5 ),\cf4 \strokec4  userName\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'user-name'\cf5 \strokec5 ),\cf4 \strokec4  userCompany\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'user-company'\cf5 \strokec5 ),\cf4 \strokec4  userAvatar\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'user-avatar'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ceoLabel\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'ceo-label'\cf5 \strokec5 ),\cf4 \strokec4  vcLabel\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'vc-label'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         modal\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal'\cf5 \strokec5 ),\cf4 \strokec4  modalOverlay\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal-overlay'\cf5 \strokec5 ),\cf4 \strokec4  modalContent\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal-content'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         modalTitle\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal-title'\cf5 \strokec5 ),\cf4 \strokec4  modalBody\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal-body'\cf5 \strokec5 ),\cf4 \strokec4  modalCloseBtn\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'modal-close-btn'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  \cf2 \strokec2 function\cf4 \strokec4  loadReports\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  querySnapshot \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  getDocs\cf5 \strokec5 (\cf4 \strokec4 collection\cf5 \strokec5 (\cf4 \strokec4 db\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 "reports"\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         reportsData \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         querySnapshot\cf5 \strokec5 .\cf4 \strokec4 forEach\cf5 \strokec5 ((\cf4 \strokec4 doc\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             reportsData\cf5 \strokec5 [\cf4 \strokec4 doc\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ]\cf4 \strokec4  \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  id\cf5 \strokec5 :\cf4 \strokec4  doc\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ...\cf4 \strokec4 doc\cf5 \strokec5 .\cf4 \strokec4 data\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         renderReportsTable\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  \cf2 \strokec2 function\cf4 \strokec4  loadPlaybooks\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  querySnapshot \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  getDocs\cf5 \strokec5 (\cf4 \strokec4 collection\cf5 \strokec5 (\cf4 \strokec4 db\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 "playbooks"\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         playbooksData \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         querySnapshot\cf5 \strokec5 .\cf4 \strokec4 forEach\cf5 \strokec5 ((\cf4 \strokec4 doc\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             playbooksData\cf5 \strokec5 [\cf4 \strokec4 doc\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ]\cf4 \strokec4  \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  id\cf5 \strokec5 :\cf4 \strokec4  doc\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ...\cf4 \strokec4 doc\cf5 \strokec5 .\cf4 \strokec4 data\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         populateCeoPlaybooks\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 async\cf4 \strokec4  \cf2 \strokec2 function\cf4 \strokec4  addNewReport\cf5 \strokec5 (\cf4 \strokec4 reportData\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  now \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  weekNumber \cf5 \strokec5 =\cf4 \strokec4  now\cf5 \strokec5 .\cf4 \strokec4 getWeek\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  newReport \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             title\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 `Weekly Update - W\cf5 \strokec5 $\{\cf4 \strokec4 weekNumber\cf5 \strokec5 \}\cf7 \strokec7 `\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             date\cf5 \strokec5 :\cf4 \strokec4  now\cf5 \strokec5 .\cf4 \strokec4 toLocaleDateString\cf5 \strokec5 (\cf7 \strokec7 'en-US'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  month\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'short'\cf5 \strokec5 ,\cf4 \strokec4  day\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'numeric'\cf5 \strokec5 ,\cf4 \strokec4  year\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'numeric'\cf4 \strokec4  \cf5 \strokec5 \}),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             status\cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'Draft'\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             metrics\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 arr\cf5 \strokec5 :\cf4 \strokec4  reportData\cf5 \strokec5 .\cf4 \strokec4 arr \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 growth\cf5 \strokec5 :\cf4 \strokec4  reportData\cf5 \strokec5 .\cf4 \strokec4 growth \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 runway\cf5 \strokec5 :\cf4 \strokec4  reportData\cf5 \strokec5 .\cf4 \strokec4 runway \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             content\cf5 \strokec5 :\cf4 \strokec4  reportData\cf5 \strokec5 .\cf4 \strokec4 fullSummary \cf5 \strokec5 ?\cf4 \strokec4  marked\cf5 \strokec5 .\cf4 \strokec4 parse\cf5 \strokec5 (\cf4 \strokec4 reportData\cf5 \strokec5 .\cf4 \strokec4 fullSummary\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'No summary available.'\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  docRef \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 await\cf4 \strokec4  addDoc\cf5 \strokec5 (\cf4 \strokec4 collection\cf5 \strokec5 (\cf4 \strokec4 db\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 "reports"\cf5 \strokec5 ),\cf4 \strokec4  newReport\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         reportsData\cf5 \strokec5 [\cf4 \strokec4 docRef\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ]\cf4 \strokec4  \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  id\cf5 \strokec5 :\cf4 \strokec4  docRef\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ...\cf4 \strokec4 newReport \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         renderReportsTable\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  renderReportsTable\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 reportsTableBody\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 reportsTableBody\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 ''\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 keys\cf5 \strokec5 (\cf4 \strokec4 reportsData\cf5 \strokec5 ).\cf4 \strokec4 length \cf5 \strokec5 ===\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              ui\cf5 \strokec5 .\cf4 \strokec4 reportsTableBody\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `<tr><td colspan="5" class="text-center p-8 text-gray-500">No reports found in the database.</td></tr>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  sortedReports \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 values\cf5 \strokec5 (\cf4 \strokec4 reportsData\cf5 \strokec5 ).\cf4 \strokec4 sort\cf5 \strokec5 ((\cf4 \strokec4 a\cf5 \strokec5 ,\cf4 \strokec4  b\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 (\cf4 \strokec4 b\cf5 \strokec5 .\cf4 \strokec4 date\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 -\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 (\cf4 \strokec4 a\cf5 \strokec5 .\cf4 \strokec4 date\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         sortedReports\cf5 \strokec5 .\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 report \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  statusClass \cf5 \strokec5 =\cf4 \strokec4  report\cf5 \strokec5 .\cf4 \strokec4 status \cf5 \strokec5 ===\cf4 \strokec4  \cf7 \strokec7 'Sent'\cf4 \strokec4  \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'text-green-800 bg-green-100'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'text-yellow-800 bg-yellow-100'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  row \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 createElement\cf5 \strokec5 (\cf7 \strokec7 'tr'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             row\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf7 \cb3 \strokec7                 <td class="p-4">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 date\cf5 \strokec5 \}\cf7 \strokec7 </td>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <td class="p-4 font-semibold">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 title\cf5 \strokec5 \}\cf7 \strokec7 </td>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <td class="p-4"><span class="px-2 py-1 text-xs font-semibold \cf5 \strokec5 $\{\cf4 \strokec4 statusClass\cf5 \strokec5 \}\cf7 \strokec7  rounded-full">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 status\cf5 \strokec5 \}\cf7 \strokec7 </span></td>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <td class="p-4 hidden md:table-cell">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 metrics\cf5 \strokec5 .\cf4 \strokec4 growth \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 \}\cf7 \strokec7 </td>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <td class="p-4 text-right"><a href="#" class="text-purple-700 hover:underline view-report-link" data-report-id="\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 \}\cf7 \strokec7 ">View</a></td>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             `\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 reportsTableBody\cf5 \strokec5 .\cf4 \strokec4 appendChild\cf5 \strokec5 (\cf4 \strokec4 row\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         document\cf5 \strokec5 .\cf4 \strokec4 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.view-report-link'\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 link \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             link\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 showViewReportModal\cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 .\cf4 \strokec4 target\cf5 \strokec5 .\cf4 \strokec4 dataset\cf5 \strokec5 .\cf4 \strokec4 reportId\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  showPage\cf5 \strokec5 (\cf4 \strokec4 pageName\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  pageMap \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf7 \strokec7 'dashboard'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 dashboard\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'recording'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 recording\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'reports'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 reports\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'playbooks'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 playbooks\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'integrations'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 integrations\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'settings'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 settings\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf7 \strokec7 'vc-dashboard'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 vcDashboard\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'vc-playbooks'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 vcPlaybooks\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'vc-settings'\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 pages\cf5 \strokec5 .\cf4 \strokec4 vcSettings\cf5 \strokec5 ,\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 values\cf5 \strokec5 (\cf4 \strokec4 pageMap\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 page \cf5 \strokec5 =>\cf4 \strokec4  page\cf5 \strokec5 ?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         pageMap\cf5 \strokec5 [\cf4 \strokec4 pageName\cf5 \strokec5 ]?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  navMap \cf5 \strokec5 =\cf4 \strokec4  currentView \cf5 \strokec5 ===\cf4 \strokec4  \cf7 \strokec7 'ceo'\cf4 \strokec4  \cf5 \strokec5 ?\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 navLinks\cf5 \strokec5 .\cf4 \strokec4 ceo \cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 navLinks\cf5 \strokec5 .\cf4 \strokec4 vc\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  navKey \cf5 \strokec5 =\cf4 \strokec4  pageName\cf5 \strokec5 .\cf4 \strokec4 replace\cf5 \strokec5 (\cf7 \strokec7 'vc-'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 ''\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 values\cf5 \strokec5 (\cf4 \strokec4 navMap\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 link \cf5 \strokec5 =>\cf4 \strokec4  link\cf5 \strokec5 ?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'active'\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         navMap\cf5 \strokec5 [\cf4 \strokec4 navKey\cf5 \strokec5 ]?.\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'active'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 sidebar\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 contains\cf5 \strokec5 (\cf7 \strokec7 'translate-x-0'\cf5 \strokec5 ))\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 sidebar\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'translate-x-0'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 sidebar\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 '-translate-x-full'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  initializeDictationService\cf5 \strokec5 (\cf4 \strokec4 apiKey\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         dictationService \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 DictationService\cf5 \cb3 \strokec5 (\{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             apiKey\cf5 \strokec5 :\cf4 \strokec4  apiKey\cf5 \strokec5 ,\cf4 \strokec4  recordButton\cf5 \strokec5 :\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 ,\cf4 \strokec4  statusTextElement\cf5 \strokec5 :\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'recording-status-text'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             onRecordingStart\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 recordingInterface\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ),\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             onRecordingStop\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 showPage\cf5 \strokec5 (\cf7 \strokec7 'recording'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 recordingInterface\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 processingState\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 completedState\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 processingStatus\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Transcribing audio...'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \},\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             onProcessingComplete\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 ,\cf4 \strokec4  rawText\cf5 \strokec5 ,\cf4 \strokec4  error\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                  latestGeneratedReport \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf5 \strokec5 ...\cf4 \strokec4 data\cf5 \strokec5 ,\cf4 \strokec4  raw\cf5 \strokec5 :\cf4 \strokec4  rawText \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                  renderCompletedState\cf5 \strokec5 (\cf4 \strokec4 latestGeneratedReport\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                  ui\cf5 \strokec5 .\cf4 \strokec4 processingState\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                  ui\cf5 \strokec5 .\cf4 \strokec4 completedState\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         updateRecordButtonState\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4      \cf2 \strokec2 function\cf4 \strokec4  renderCompletedState\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 extractedIntelligenceContainer\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `<h4 class="font-bold text-sm mb-4">Error</h4><div class="bg-white p-6 border border-red-200 rounded-lg"><p class="text-red-600">\cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 error\cf5 \strokec5 \}\cf7 \strokec7 </p></div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 strategicUpdateContainer\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `<h4 class="font-bold text-sm mb-4">Strategic Update</h4><div class="bg-white border-2 border-gray-200 p-6 rounded-lg shadow-lg"><p class="text-gray-500">Could not be generated due to an error.</p></div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  renderList \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 items\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  items \cf5 \strokec5 &&\cf4 \strokec4  items\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 >\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf4 \cb3 \strokec4  \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 `<ul>\cf5 \strokec5 $\{\cf4 \strokec4 items\cf5 \strokec5 .\cf4 \strokec4 map\cf5 \strokec5 (\cf4 \strokec4 item \cf5 \strokec5 =>\cf4 \strokec4  \cf7 \strokec7 `<li class="flex items-start gap-2"><span class="text-purple-600">\uc0\u8594 </span><span>\cf5 \strokec5 $\{\cf4 \strokec4 item\cf5 \strokec5 \}\cf7 \strokec7 </span></li>`\cf5 \strokec5 ).\cf4 \strokec4 join\cf5 \strokec5 (\cf7 \strokec7 ''\cf5 \strokec5 )\}\cf7 \strokec7 </ul>`\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 '<p class="text-gray-500">None mentioned.</p>'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4          \cf2 \strokec2 const\cf4 \strokec4  fullSummaryHtml \cf5 \strokec5 =\cf4 \strokec4  data\cf5 \strokec5 .\cf4 \strokec4 fullSummary \cf5 \strokec5 ?\cf4 \strokec4  marked\cf5 \strokec5 .\cf4 \strokec4 parse\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 fullSummary\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 '<p class="text-gray-500">Summary not available.</p>'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  intelligenceHtml \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf7 \cb3 \strokec7             <div class="space-y-4">\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><h4 class="font-bold text-sm mb-2 text-green-600">Key Wins</h4>\cf5 \strokec5 $\{\cf4 \strokec4 renderList\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 wins\cf5 \strokec5 )\}\cf7 \strokec7 </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><h4 class="font-bold text-sm mb-2 text-amber-600">Key Challenges</h4>\cf5 \strokec5 $\{\cf4 \strokec4 renderList\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 challenges\cf5 \strokec5 )\}\cf7 \strokec7 </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><h4 class="font-bold text-sm mb-2 text-blue-600">Strategic Insights</h4>\cf5 \strokec5 $\{\cf4 \strokec4 renderList\cf5 \strokec5 (\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 insights\cf5 \strokec5 )\}\cf7 \strokec7 </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div class="pt-4 border-t"><h4 class="font-bold text-sm mb-2">Full Transcript</h4><p class="text-xs italic text-gray-500 max-h-32 overflow-y-auto">\cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 raw \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'Not available.'\cf5 \strokec5 \}\cf7 \strokec7 </p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             </div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 extractedIntelligenceContainer\cf5 \strokec5 .\cf4 \strokec4 querySelector\cf5 \strokec5 (\cf7 \strokec7 '.bg-white'\cf5 \strokec5 ).\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  intelligenceHtml\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  strategicHtml \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf7 \cb3 \strokec7             <div class="flex items-center justify-between mb-6"><div><h3 class="font-bold text-xl">Strategic Update</h3><p class="text-sm text-gray-600 mono">Week \cf5 \strokec5 $\{\cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 ().\cf4 \strokec4 getWeek\cf5 \strokec5 ()\}\cf7 \strokec7  \'95 \cf5 \strokec5 $\{\cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 ().\cf4 \strokec4 getFullYear\cf5 \strokec5 ()\}\cf7 \strokec7 </p></div><span class="text-sm bg-green-100 text-green-800 px-3 py-1 rounded-full">Momentum Building</span></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7              <div class="grid grid-cols-3 gap-4 mb-6">\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div class="text-center p-3 bg-gray-50 rounded"><p class="font-bold text-xl">\cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 arr \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">ARR</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div class="text-center p-3 bg-gray-50 rounded"><p class="font-bold text-xl \cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 growth \cf5 \strokec5 &&\cf4 \strokec4  data\cf5 \strokec5 .\cf4 \strokec4 growth\cf5 \strokec5 .\cf4 \strokec4 startsWith\cf5 \strokec5 (\cf7 \strokec7 '+'\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'text-green-600'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'text-red-600'\cf5 \strokec5 \}\cf7 \strokec7 ">\cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 growth \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">Growth</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div class="text-center p-3 bg-gray-50 rounded"><p class="font-bold text-xl">\cf5 \strokec5 $\{\cf4 \strokec4 data\cf5 \strokec5 .\cf4 \strokec4 runway \cf5 \strokec5 ||\cf4 \strokec4  \cf7 \strokec7 'N/A'\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">Runway</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             <div class="prose prose-sm max-w-none">\cf5 \strokec5 $\{\cf4 \strokec4 fullSummaryHtml\cf5 \strokec5 \}\cf7 \strokec7 </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             <button id="finalize-report-btn" class="mt-6 w-full bg-purple-700 text-white py-2 text-sm font-bold hover:bg-purple-800 transition-colors rounded-md">Save Report to Database \uc0\u8594 </button>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7         `\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 strategicUpdateContainer\cf5 \strokec5 .\cf4 \strokec4 querySelector\cf5 \strokec5 (\cf7 \strokec7 '.bg-white'\cf5 \strokec5 ).\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  strategicHtml\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         document\cf5 \strokec5 .\cf4 \strokec4 getElementById\cf5 \strokec5 (\cf7 \strokec7 'finalize-report-btn'\cf5 \strokec5 ).\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             addNewReport\cf5 \strokec5 (\cf4 \strokec4 latestGeneratedReport\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             showPage\cf5 \strokec5 (\cf7 \strokec7 'reports'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 .\cf4 \strokec4 prototype\cf5 \strokec5 .\cf4 \strokec4 getWeek \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 function\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf2 \strokec2 var\cf4 \strokec4  d \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 (\cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 .\cf6 \cb3 \strokec6 UTC\cf5 \cb3 \strokec5 (\cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 getFullYear\cf5 \strokec5 (),\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 getMonth\cf5 \strokec5 (),\cf4 \strokec4  \cf2 \strokec2 this\cf5 \strokec5 .\cf4 \strokec4 getDate\cf5 \strokec5 ()));\cf4 \strokec4  \cf2 \strokec2 var\cf4 \strokec4  dayNum \cf5 \strokec5 =\cf4 \strokec4  d\cf5 \strokec5 .\cf4 \strokec4 getUTCDay\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 ||\cf4 \strokec4  \cf9 \cb3 \strokec9 7\cf5 \cb3 \strokec5 ;\cf4 \strokec4  d\cf5 \strokec5 .\cf4 \strokec4 setUTCDate\cf5 \strokec5 (\cf4 \strokec4 d\cf5 \strokec5 .\cf4 \strokec4 getUTCDate\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 +\cf4 \strokec4  \cf9 \cb3 \strokec9 4\cf4 \cb3 \strokec4  \cf5 \strokec5 -\cf4 \strokec4  dayNum\cf5 \strokec5 );\cf4 \strokec4  \cf2 \strokec2 var\cf4 \strokec4  yearStart \cf5 \strokec5 =\cf4 \strokec4  \cf2 \strokec2 new\cf4 \strokec4  \cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 (\cf6 \cb3 \strokec6 Date\cf5 \cb3 \strokec5 .\cf6 \cb3 \strokec6 UTC\cf5 \cb3 \strokec5 (\cf4 \strokec4 d\cf5 \strokec5 .\cf4 \strokec4 getUTCFullYear\cf5 \strokec5 (),\cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 ,\cf9 \cb3 \strokec9 1\cf5 \cb3 \strokec5 ));\cf4 \strokec4  \cf2 \strokec2 return\cf4 \strokec4  \cf6 \cb3 \strokec6 Math\cf5 \cb3 \strokec5 .\cf4 \strokec4 ceil\cf5 \strokec5 ((((\cf4 \strokec4 d \cf5 \strokec5 -\cf4 \strokec4  yearStart\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 /\cf4 \strokec4  \cf9 \cb3 \strokec9 86400000\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 +\cf4 \strokec4  \cf9 \cb3 \strokec9 1\cf5 \cb3 \strokec5 )/\cf9 \cb3 \strokec9 7\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  updateRecordButtonState\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  isReady \cf5 \strokec5 =\cf4 \strokec4  dictationService \cf5 \strokec5 &&\cf4 \strokec4  dictationService\cf5 \strokec5 .\cf4 \strokec4 isReady\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  buttons \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 [\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 startRecordingBtn\cf5 \strokec5 ,\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 recordButton\cf5 \strokec5 ,\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 newReportBtn\cf5 \strokec5 ];\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         buttons\cf5 \strokec5 .\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 btn \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 btn\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 btn\cf5 \strokec5 .\cf4 \strokec4 disabled \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 !\cf4 \strokec4 isReady\cf5 \strokec5 ;\cf4 \strokec4  btn\cf5 \strokec5 .\cf4 \strokec4 style\cf5 \strokec5 .\cf4 \strokec4 cursor \cf5 \strokec5 =\cf4 \strokec4  isReady \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'pointer'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'not-allowed'\cf5 \strokec5 ;\cf4 \strokec4  btn\cf5 \strokec5 .\cf4 \strokec4 style\cf5 \strokec5 .\cf4 \strokec4 opacity \cf5 \strokec5 =\cf4 \strokec4  isReady \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 '1'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 '0.5'\cf5 \strokec5 ;\cf4 \strokec4  btn\cf5 \strokec5 .\cf4 \strokec4 title \cf5 \strokec5 =\cf4 \strokec4  isReady \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'Start Recording'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'API Key not configured'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 apiKeyBanner\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ,\cf4 \strokec4  isReady\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  saveApiKey\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  apiKey \cf5 \strokec5 =\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 apiKeyInput\cf5 \strokec5 .\cf4 \strokec4 value\cf5 \strokec5 .\cf4 \strokec4 trim\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 apiKey\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             localStorage\cf5 \strokec5 .\cf4 \strokec4 setItem\cf5 \strokec5 (\cf7 \strokec7 'geminiApiKey'\cf5 \strokec5 ,\cf4 \strokec4  apiKey\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             initializeDictationService\cf5 \strokec5 (\cf4 \strokec4 apiKey\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 apiKeyStatus\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'API Key saved!'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              setTimeout\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 ui\cf5 \strokec5 .\cf4 \strokec4 apiKeyStatus\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 ''\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 dictationService\cf5 \strokec5 .\cf4 \strokec4 isReady\cf5 \strokec5 ())\cf4 \strokec4  showPage\cf5 \strokec5 (\cf7 \strokec7 'dashboard'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \},\cf4 \strokec4  \cf9 \cb3 \strokec9 2000\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  switchView\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  isVcView \cf5 \strokec5 =\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 viewToggle\cf5 \strokec5 .\cf4 \strokec4 checked\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         currentView \cf5 \strokec5 =\cf4 \strokec4  isVcView \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'vc'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'ceo'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 ceoView\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ,\cf4 \strokec4  isVcView\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 vcView\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 !\cf4 \strokec4 isVcView\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 ceoNav\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ,\cf4 \strokec4  isVcView\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 vcNav\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 !\cf4 \strokec4 isVcView\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 isVcView\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 userName\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Sarah (Partner)'\cf5 \strokec5 ;\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 userCompany\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Alpha Ventures'\cf5 \strokec5 ;\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 userAvatar\cf5 \strokec5 .\cf4 \strokec4 src \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'https://placehold.co/100x100/8B5CF6/FFFFFF?text=S'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 vcLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'font-semibold'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'text-purple-700'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 vcLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'text-gray-500'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 ceoLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'font-semibold'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'text-purple-700'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 ceoLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'text-gray-500'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             showPage\cf5 \strokec5 (\cf7 \strokec7 'vc-dashboard'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \strokec4  \cf2 \strokec2 else\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 userName\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Alex (CEO)'\cf5 \strokec5 ;\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 userCompany\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'Acme Inc.'\cf5 \strokec5 ;\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 userAvatar\cf5 \strokec5 .\cf4 \strokec4 src \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 'https://placehold.co/100x100/5B21B6/FFFFFF?text=A'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 ceoLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'font-semibold'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'text-purple-700'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 ceoLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'text-gray-500'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 vcLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'font-semibold'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'text-purple-700'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 vcLabel\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'text-gray-500'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             showPage\cf5 \strokec5 (\cf7 \strokec7 'dashboard'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  showModal\cf5 \strokec5 (\cf4 \strokec4 title\cf5 \strokec5 ,\cf4 \strokec4  body\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modalTitle\cf5 \strokec5 .\cf4 \strokec4 textContent \cf5 \strokec5 =\cf4 \strokec4  title\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modalBody\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 ''\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modalBody\cf5 \strokec5 .\cf4 \strokec4 appendChild\cf5 \strokec5 (\cf4 \strokec4 body\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modal\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         setTimeout\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 modalOverlay\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'opacity-0'\cf5 \strokec5 );\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 modalContent\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 remove\cf5 \strokec5 (\cf7 \strokec7 'scale-95'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'opacity-0'\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \},\cf4 \strokec4  \cf9 \cb3 \strokec9 10\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  hideModal\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modalOverlay\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'opacity-0'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 modalContent\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'scale-95'\cf5 \strokec5 ,\cf4 \strokec4  \cf7 \strokec7 'opacity-0'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         setTimeout\cf5 \strokec5 (()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 modal\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 add\cf5 \strokec5 (\cf7 \strokec7 'hidden'\cf5 \strokec5 ),\cf4 \strokec4  \cf9 \cb3 \strokec9 300\cf5 \cb3 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  showViewReportModal\cf5 \strokec5 (\cf4 \strokec4 reportId\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  report \cf5 \strokec5 =\cf4 \strokec4  reportsData\cf5 \strokec5 [\cf4 \strokec4 reportId\cf5 \strokec5 ];\cf4 \strokec4  \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (!\cf4 \strokec4 report\cf5 \strokec5 )\cf4 \strokec4  \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  content \cf5 \strokec5 =\cf4 \strokec4  document\cf5 \strokec5 .\cf4 \strokec4 createElement\cf5 \strokec5 (\cf7 \strokec7 'div'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  growthClass \cf5 \strokec5 =\cf4 \strokec4  report\cf5 \strokec5 .\cf4 \strokec4 metrics\cf5 \strokec5 .\cf4 \strokec4 growth\cf5 \strokec5 .\cf4 \strokec4 startsWith\cf5 \strokec5 (\cf7 \strokec7 '+'\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 ?\cf4 \strokec4  \cf7 \strokec7 'text-green-600'\cf4 \strokec4  \cf5 \strokec5 :\cf4 \strokec4  \cf7 \strokec7 'text-red-600'\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         content\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf7 \cb3 \strokec7             <div class="grid grid-cols-3 gap-4 mb-6 text-center">\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><p class="font-bold text-2xl">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 metrics\cf5 \strokec5 .\cf4 \strokec4 arr\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">ARR</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><p class="font-bold text-2xl \cf5 \strokec5 $\{\cf4 \strokec4 growthClass\cf5 \strokec5 \}\cf7 \strokec7 ">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 metrics\cf5 \strokec5 .\cf4 \strokec4 growth\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">MoM Growth</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 <div><p class="font-bold text-2xl">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 metrics\cf5 \strokec5 .\cf4 \strokec4 runway\cf5 \strokec5 \}\cf7 \strokec7 </p><p class="text-xs text-gray-600">Runway</p></div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7             <div class="prose prose-sm max-w-none">\cf5 \strokec5 $\{\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 content\cf5 \strokec5 \}\cf7 \strokec7 </div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4         showModal\cf5 \strokec5 (\cf4 \strokec4 report\cf5 \strokec5 .\cf4 \strokec4 title\cf5 \strokec5 ,\cf4 \strokec4  content\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  populateCeoPlaybooks\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  activeCategories \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Array\cf5 \cb3 \strokec5 .\cf2 \strokec2 from\cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 playbookCategoryFilters\cf5 \strokec5 .\cf4 \strokec4 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '.playbook-category-btn.active'\cf5 \strokec5 )).\cf4 \strokec4 map\cf5 \strokec5 (\cf4 \strokec4 btn \cf5 \strokec5 =>\cf4 \strokec4  btn\cf5 \strokec5 .\cf4 \strokec4 dataset\cf5 \strokec5 .\cf4 \strokec4 category\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  categories \cf5 \strokec5 =\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  \cf7 \strokec7 'Growth'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 [],\cf4 \strokec4  \cf7 \strokec7 'Hiring'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 [],\cf4 \strokec4  \cf7 \strokec7 'Fundraising'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 [],\cf4 \strokec4  \cf7 \strokec7 'Product'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 [],\cf4 \strokec4  \cf7 \strokec7 'Sales'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 [],\cf4 \strokec4  \cf7 \strokec7 'Legal'\cf5 \strokec5 :\cf4 \strokec4  \cf5 \strokec5 []\cf4 \strokec4  \cf5 \strokec5 \};\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 let\cf4 \strokec4  visiblePlaybooks \cf5 \strokec5 =\cf4 \strokec4  \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 values\cf5 \strokec5 (\cf4 \strokec4 playbooksData\cf5 \strokec5 ).\cf4 \strokec4 filter\cf5 \strokec5 (\cf4 \strokec4 playbook \cf5 \strokec5 =>\cf4 \strokec4  playbook\cf5 \strokec5 .\cf4 \strokec4 category \cf5 \strokec5 &&\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 activeCategories\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 ===\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf4 \cb3 \strokec4  \cf5 \strokec5 ||\cf4 \strokec4  activeCategories\cf5 \strokec5 .\cf4 \strokec4 includes\cf5 \strokec5 (\cf4 \strokec4 playbook\cf5 \strokec5 .\cf4 \strokec4 category\cf5 \strokec5 )));\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 visiblePlaybooks\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 ===\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf4 \cb3 \strokec4  \cf5 \strokec5 &&\cf4 \strokec4  \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 keys\cf5 \strokec5 (\cf4 \strokec4 playbooksData\cf5 \strokec5 ).\cf4 \strokec4 length \cf5 \strokec5 >\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             ui\cf5 \strokec5 .\cf4 \strokec4 ceoPlaybookList\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `<div class="text-center text-gray-500 col-span-full">No playbooks found for the selected categories.</div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf5 \strokec5 (\cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 keys\cf5 \strokec5 (\cf4 \strokec4 playbooksData\cf5 \strokec5 ).\cf4 \strokec4 length \cf5 \strokec5 ===\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4              ui\cf5 \strokec5 .\cf4 \strokec4 ceoPlaybookList\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `<div class="text-center text-gray-500 col-span-full">Loading playbooks...</div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 return\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         visiblePlaybooks\cf5 \strokec5 .\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 p \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 const\cf4 \strokec4  html \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 `\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf7 \cb3 \strokec7                 <div class="bg-white border border-gray-200 p-4 rounded-lg flex justify-between items-center group">\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                     <div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                         <p class="font-semibold">\cf5 \strokec5 $\{\cf4 \strokec4 p\cf5 \strokec5 .\cf4 \strokec4 title\cf5 \strokec5 \}\cf7 \strokec7 </p>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                         <p class="text-sm text-gray-500">from \cf5 \strokec5 $\{\cf4 \strokec4 p\cf5 \strokec5 .\cf4 \strokec4 company\cf5 \strokec5 \}\cf7 \strokec7 </p>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                     </div>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                     <button class="playbook-view-btn text-xs bg-gray-200 text-gray-700 px-3 py-1 rounded-full font-semibold hover:bg-gray-300" data-playbook-id="\cf5 \strokec5 $\{\cf4 \strokec4 p\cf5 \strokec5 .\cf4 \strokec4 id\cf5 \strokec5 \}\cf7 \strokec7 ">View</button>\cf4 \cb1 \strokec4 \
\cf7 \cb3 \strokec7                 </div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 \strokec4             \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 categories\cf5 \strokec5 [\cf4 \strokec4 p\cf5 \strokec5 .\cf4 \strokec4 category\cf5 \strokec5 ])\cf4 \strokec4  categories\cf5 \strokec5 [\cf4 \strokec4 p\cf5 \strokec5 .\cf4 \strokec4 category\cf5 \strokec5 ].\cf4 \strokec4 push\cf5 \strokec5 (\cf4 \strokec4 html\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 let\cf4 \strokec4  fullHtml \cf5 \strokec5 =\cf4 \strokec4  \cf7 \strokec7 ''\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 for\cf4 \strokec4  \cf5 \strokec5 (\cf2 \strokec2 const\cf4 \strokec4  \cf5 \strokec5 [\cf4 \strokec4 categoryName\cf5 \strokec5 ,\cf4 \strokec4  items\cf5 \strokec5 ]\cf4 \strokec4  \cf2 \strokec2 of\cf4 \strokec4  \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 entries\cf5 \strokec5 (\cf4 \strokec4 categories\cf5 \strokec5 ))\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 items\cf5 \strokec5 .\cf4 \strokec4 length \cf5 \strokec5 >\cf4 \strokec4  \cf9 \cb3 \strokec9 0\cf5 \cb3 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4                 fullHtml \cf5 \strokec5 +=\cf4 \strokec4  \cf7 \strokec7 `<div><h3 class="font-bold mb-4 pb-2 border-b border-gray-200">\cf5 \strokec5 $\{\cf4 \strokec4 categoryName\cf5 \strokec5 \}\cf7 \strokec7 </h3><div class="space-y-4 text-sm">\cf5 \strokec5 $\{\cf4 \strokec4 items\cf5 \strokec5 .\cf4 \strokec4 join\cf5 \strokec5 (\cf7 \strokec7 ''\cf5 \strokec5 )\}\cf7 \strokec7 </div></div>`\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         ui\cf5 \strokec5 .\cf4 \strokec4 ceoPlaybookList\cf5 \strokec5 .\cf4 \strokec4 innerHTML \cf5 \strokec5 =\cf4 \strokec4  fullHtml\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4         document\cf5 \strokec5 .\cf4 \strokec4 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '#ceo-playbook-list .playbook-view-btn'\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 link \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             link\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 stopPropagation\cf5 \strokec5 ();\cf4 \strokec4  \cf8 \strokec8 /* showPlaybookModal(e.currentTarget.dataset.playbookId); */\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 function\cf4 \strokec4  populateVcPortfolio\cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf8 \strokec8 // This function would also need to be converted to fetch from Firestore\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf8 \strokec8 // For now, it is a placeholder.\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf8 \strokec8 // --- Initial Load ---\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 const\cf4 \strokec4  savedApiKey \cf5 \strokec5 =\cf4 \strokec4  localStorage\cf5 \strokec5 .\cf4 \strokec4 getItem\cf5 \strokec5 (\cf7 \strokec7 'geminiApiKey'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 savedApiKey\cf5 \strokec5 )\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 apiKeyInput\cf5 \strokec5 .\cf4 \strokec4 value \cf5 \strokec5 =\cf4 \strokec4  savedApiKey\cf5 \strokec5 ;\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     initializeDictationService\cf5 \strokec5 (\cf4 \strokec4 savedApiKey\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     loadReports\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     loadPlaybooks\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf8 \strokec8 // --- Event Listeners Setup ---\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 entries\cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 navLinks\cf5 \strokec5 .\cf4 \strokec4 ceo\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (([\cf4 \strokec4 name\cf5 \strokec5 ,\cf4 \strokec4  link\cf5 \strokec5 ])\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  link\cf5 \strokec5 ?.\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \strokec4  showPage\cf5 \strokec5 (\cf4 \strokec4 name\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \}));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf6 \cb3 \strokec6 Object\cf5 \cb3 \strokec5 .\cf4 \strokec4 entries\cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 navLinks\cf5 \strokec5 .\cf4 \strokec4 vc\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (([\cf4 \strokec4 name\cf5 \strokec5 ,\cf4 \strokec4  link\cf5 \strokec5 ])\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  link\cf5 \strokec5 ?.\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \strokec4  showPage\cf5 \strokec5 (\cf7 \strokec7 `vc-\cf5 \strokec5 $\{\cf4 \strokec4 name\cf5 \strokec5 \}\cf7 \strokec7 `\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \}));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 bannerSettingsLink\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \strokec4  showPage\cf5 \strokec5 (\cf7 \strokec7 'settings'\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 mobileMenuBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 sidebar\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 '-translate-x-full'\cf5 \strokec5 );\cf4 \strokec4  \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 startRecordingBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  dictationService\cf5 \strokec5 ?.\cf4 \strokec4 toggleRecording\cf5 \strokec5 ());\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 newReportBtn\cf5 \strokec5 )\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 newReportBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  showPage\cf5 \strokec5 (\cf7 \strokec7 'dashboard'\cf5 \strokec5 ));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 saveApiKeyBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  saveApiKey\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 viewToggle\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'change'\cf5 \strokec5 ,\cf4 \strokec4  switchView\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     \cf2 \strokec2 if\cf5 \strokec5 (\cf4 \strokec4 ui\cf5 \strokec5 .\cf4 \strokec4 authorPlaybookBtn\cf5 \strokec5 )\cf4 \strokec4  ui\cf5 \strokec5 .\cf4 \strokec4 authorPlaybookBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 ()\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\});\cf4 \cb1 \strokec4 \
\
\cf4 \cb3 \strokec4     document\cf5 \strokec5 .\cf4 \strokec4 querySelectorAll\cf5 \strokec5 (\cf7 \strokec7 '#page-vc-playbooks .playbook-link'\cf5 \strokec5 ).\cf4 \strokec4 forEach\cf5 \strokec5 (\cf4 \strokec4 link \cf5 \strokec5 =>\cf4 \strokec4  link\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 preventDefault\cf5 \strokec5 ();\cf4 \strokec4  \cf5 \strokec5 \}));\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 modalCloseBtn\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  hideModal\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 modalOverlay\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  hideModal\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     ui\cf5 \strokec5 .\cf4 \strokec4 playbookCategoryFilters\cf5 \strokec5 .\cf4 \strokec4 addEventListener\cf5 \strokec5 (\cf7 \strokec7 'click'\cf5 \strokec5 ,\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 e\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 =>\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 const\cf4 \strokec4  targetButton \cf5 \strokec5 =\cf4 \strokec4  e\cf5 \strokec5 .\cf4 \strokec4 target\cf5 \strokec5 .\cf4 \strokec4 closest\cf5 \strokec5 (\cf7 \strokec7 '.playbook-category-btn'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf2 \strokec2 if\cf4 \strokec4  \cf5 \strokec5 (\cf4 \strokec4 targetButton\cf5 \strokec5 )\cf4 \strokec4  \cf5 \strokec5 \{\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             targetButton\cf5 \strokec5 .\cf4 \strokec4 classList\cf5 \strokec5 .\cf4 \strokec4 toggle\cf5 \strokec5 (\cf7 \strokec7 'active'\cf5 \strokec5 );\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4             populateCeoPlaybooks\cf5 \strokec5 ();\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4         \cf5 \strokec5 \}\cf4 \cb1 \strokec4 \
\cf4 \cb3 \strokec4     \cf5 \strokec5 \});\cf4 \cb1 \strokec4 \
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 \strokec5 \});\cf4 \cb1 \strokec4 \
\
}